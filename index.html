<html>

<head>
	<script src="lib/jquery-3.0.0.js"></script>
	<script src="lib/nools.js"></script>
	<style>
		#content > div { width:300px; float:left; margin:20px; }
		textarea { width:100%; height:70%; }
	</style>
</head>

<body>
<div id="content">
	<div id="rules">
		<h1>Rules</h1>
		<textarea></textarea>
	</div>
	<div id="test-script">
		<h1>Test script</h1>
		<textarea></textarea>
		<button id="exec">Run</button>
	</div>
	<div id="log">
		<h1>Log</h1>
		<textarea disabled></textarea>
	</div>
</div>

<script>
function clearLog() { $('#log textarea').val(''); }
function log() {
	args = Array.prototype.slice.call(arguments, 0);
	console.log.apply(console, args);

	var ta = $('#log textarea');
	ta.val(ta.val() + args.join(' ') + '\n\n');
	ta.scrollTop(ta[0].scrollHeight);
}

$('#exec').click(function() {
	clearLog();

	var ruleScript = $('#rules textarea').val();
	log('Processing rule script...');

	var flow;
	try {
		flow = nools.transpile(ruleScript);
		log('Rules parsed OK!');
	} catch(e) {
		log('Failed to parse rule script.', e);
		throw e;
	}
});
</script>
</body>

</html>
